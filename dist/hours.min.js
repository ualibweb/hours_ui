angular.module("hours.templates",["calendar/calendar.tpl.html","hours-locations/hours-locations.tpl.html","lib-hours-today/lib-hours-today.tpl.html","list/list.tpl.html"]),angular.module("calendar/calendar.tpl.html",[]).run(["$templateCache",function(a){a.put("calendar/calendar.tpl.html",'<div class="calendar">\n    <div class="form-group">\n        <div class="btn-group">\n            <button class="btn btn-default" ng-model="calView" btn-radio="">Typical Schedule</button>\n            <button class="btn btn-default" ng-model="calView" btn-radio="1">Calendar &amp; Exceptions</button>\n        </div>\n    </div>\n    <div ng-show="!calView">\n        <div class="text-info" ng-show="defHours[1].ts > 0">\n            <span class="fa fw fa-info-circle"></span> Until {{defHours[1].ts * 1000 | date:\'MMM d, y\'}}\n        </div>\n        <table class="table table-bordered table-condensed">\n            <thead>\n                <tr>\n                    <th scope="col" aria-label="Sunday">Sun</th>\n                    <th scope="col" aria-label="Monday">Mon</th>\n                    <th scope="col" aria-label="Tuesday">Tues</th>\n                    <th scope="col" aria-label="Wednesday">Wed</th>\n                    <th scope="col" aria-label="Thursday">Thurs</th>\n                    <th scope="col" aria-label="Friday">Fri</th>\n                    <th scope="col" aria-label="Saturday">Sat</th>\n                </tr>\n            </thead>\n            <tbody>\n            <tr>\n\n                <td ng-repeat="day in defHours[0].hours" tabindex="0">\n                    <div class="hours">\n                        {{day.hoursFrom}}<span ng-show="day.hoursFrom != day.hoursTo"> to <br /> {{day.hoursTo}}</span>\n                    </div>\n                </td>\n            </tr>\n            </tbody>\n        </table>\n    </div>\n    <div ng-show="calView">\n        <nav class="navbar navbar-default navbar-embedded">\n            <button type="button" class="btn btn-primary navbar-btn navbar-left" ng-class="{\'disabled\': params.month <= 0}" ng-disabled="params.month <= 0" ng-click="getPrevMonth()">\n                <span class="fa fa-angle-left"></span>\n            </button>\n            <h2 class="navbar-text navbar-center">{{cal.month}}</h2>\n            <button type="button" class="btn btn-primary navbar-btn navbar-right" ng-class="{\'disabled\': params.month >= 5}" ng-disabled="params.month >= 5" ng-click="getNextMonth()"><span class="fa fa-angle-right"></span></button>\n        </nav>\n        <table class="table table-bordered table-condensed">\n            <thead>\n            <tr>\n                <td>Sun</td>\n                <td>Mon</td>\n                <td>Tue</td>\n                <td>Wed</td>\n                <td>Thur</td>\n                <td>Fri</td>\n                <td>Sat</td>\n            </tr>\n            </thead>\n            <tbody>\n            <tr ng-repeat="week in cal.weeks">\n                <td ng-repeat="day in week" ng-class="day.css">\n\n                    <div class="date">\n                        {{day.ts * 1000 | date:\'d\'}}\n                    </div>\n                    <div class="hours">\n                        {{day.hoursFrom}}\n                        <div ng-if="day.hoursFrom != day.hoursTo">\n                            {{day.hoursTo}}\n                        </div>\n                    </div>\n\n\n                    <div class="fa fa-exclamation-circle exception-icon" ng-if="day.exc" popover="{{day.exc}}" popover-trigger="mouseenter" popover-append-to-body="true"></div>\n                </td>\n            </tr>\n            </tbody>\n        </table>\n    </div>\n\n\n\n</div>')}]),angular.module("hours-locations/hours-locations.tpl.html",[]).run(["$templateCache",function(a){a.put("hours-locations/hours-locations.tpl.html",'\x3c!--<script src=\'//maps.googleapis.com/maps/api/js?sensor=false&key=AIzaSyCdXuKwZiDx5W2uP8plV5d-o-jLQ5UQtIQ&mid=z4A8-271j5C8.kowwE312jycE\'><\/script>--\x3e\n\n\n<div class="jumbotron-header">\n    <div class="jumbotron">\n        <div class="container">\n            <div class="row">\n                <div class="col-sm-12">\n                    <ol class="breadcrumb" typeof="BreadcrumbList" vocab="http://schema.org/">\n                        <li><a title="Go to The University of Alabama Libraries." href="/#/home" class="home">The University of Alabama Libraries</a></li>\n                        <li><a title="Go to Hours." href="/#/hours" class="post post-page">Hours</a></li>\n                    </ol>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-sm-8">\n                    <h1>Hours & Locations</h1>\n                    <h2 class="hidden-xs hidden-sm">{{library}}</h2>\n                    <div class="dropdown multipage-menu visible-xs visible-sm">\n                        <button class="btn btn-default btn-lg dropdown-toggle" id="locationMenu"  type="button">\n                            {{library}}\n                        </button>\n                        <ul class="dropdown-menu nav nav-stacked hours-locations-menu" role="menu" aria-labelledby="locationMenu">\n                            <li><a href="#" hours-href="{library: \'gorgas\', month: 0}">Gorgas</a>\n                                <ul class="nav nav-stacked">\n                                    <li><a href="#" hours-href="{library: \'music\', month: 0}">Music Library</a></li>\n                                    <li><a href="#" hours-href="{library: \'media\', month: 0}">Sanford Media Center</a></li>\n                                    <li><a href="#" hours-href="{library: \'williams\', month: 0}">Williams Americana Collection</a></li>\n                                </ul>\n                            </li>\n                            <li><a href="#" hours-href="{library: \'rodgers\', month: 0}">Rodgers</a></li>\n                            <li><a href="#" hours-href="{library: \'mclure\', month: 0}">McLure</a></li>\n                            <li><a href="#" hours-href="{library: \'hoole\', month: 0}">Hoole</a></li>\n                            <li><a href="#" hours-href="{library: \'bruno\', month: 0}">Bruno</a></li>\n                        </ul>\n                    </div>\n                    <ul class="list-unstyled fa-ul" ng-if="contact">\n                        <li ng-if="contact.email"><span class="fa fa-li fa-envelope"></span> <a ng-href="mailto:{{contact.email}}">{{contact.email}}</a></li>\n                        <li ng-if="contact.phone">\n                            <span class="fa fa-li fa-phone"></span>\n                            <ul class="list-unstyled">\n                                <li ng-repeat="phone in contact.phone">\n                                    <span ng-if="phone.dept">{{phone.dept}}: </span>\n                                    <a ng-href="tel:+1-205-{{phone.number}}" title="{{library}} phone number">{{phone.number}}</a>\n                                </li>\n                            </ul>\n                        </li>\n                    </ul>\n                </div>\n                <div class="col-sm-4">\n                    <div class="well">\n                        <p class="lead">What can {{library}} do for you?</p>\n                        <a ng-href="{{moreLink}}" class="btn btn-primary btn-primary-dark">Learn more <span class="fa fa-fw fa-info-circle"></span></a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="container">\n    <div class="row">\n        <div class="col-md-3 col-md-push-9">\n            <div class="hidden-xs hidden-sm">\n                <ul class="nav nav-pills nav-stacked hours-locations-menu">\n                    <li><a href="#" hours-href="{library: \'gorgas\', month: 0}">Gorgas</a>\n                        <ul class="nav nav-pills nav-stacked">\n                            <li><a href="#" hours-href="{library: \'media\', month: 0}">Sanford Media Center</a></li>\n                        </ul>\n                    </li>\n                    <li><a href="#" hours-href="{library: \'rodgers\', month: 0}">Rodgers</a></li>\n                    <li><a href="#" hours-href="{library: \'mclure\', month: 0}">McLure</a></li>\n                    <li><a href="#" hours-href="{library: \'hoole\', month: 0}">Hoole</a></li>\n                    <li><a href="#" hours-href="{library: \'bruno\', month: 0}">Bruno</a></li>\n                </ul>\n            </div>\n        </div>\n        <div class="col-md-9 col-md-pull-3">\n\n            <div class="row">\n                <div class="col-md-12">\n                    <div class="hours-calendar"></div>\n                </div>\n            </div>\n\n\n             <div class="row">\n                <div class="col-md-12">\n                    <div class="panel panel-default">\n                        <div class="panel-body">\n                            <div map-lazy-load="https://maps.google.com/maps/api/js"\n                                 map-lazy-load-params="{{googleMapsUrl}}">\n                                <ng-map center=\'{{center}}\' zoom=\'18\' scrollwheel="false" id="map-canvas" map-initialized="updateMap()">\n                                    <marker\n                                            ng-repeat="l in loc"\n                                            no-watcher="true"\n                                            position="{{l.latitude}}, {{l.longitude}}"\n                                            title="{{l.name}}"></marker>\n                                </ng-map>\n                            </div>\n                        </div>\n\n                        <div class="panel-footer">\n                            <form ng-submit="getDirections()">\n                                <div class="input-group">\n                                    <input type="text" class="form-control" ng-model="directionsFrom" placeholder="Your address or location" required>\n                        <span class="input-group-btn">\n                            <button type="submit" class="btn btn-default" target="_gmaps">Get Directions <span class="fa fa-external-link"></span></button>\n                        </span>\n                                </div>\n                            </form>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    </div>\n</div>\n')}]),angular.module("lib-hours-today/lib-hours-today.tpl.html",[]).run(["$templateCache",function(a){a.put("lib-hours-today/lib-hours-today.tpl.html",'<div class="library-hours-today" ng-cloak>\n    <div class="media">\n        <div class="media-left">\n            <div class="media-object fa fa-2x fa-clock-o">\n            </div>\n        </div>\n        <div class="media-body">\n            <h3 class="media-heading">Today</h3>\n            <h4 class="media-heading">{{today.hours}} <span class="fa fa-lg fa-info-circle" ng-if="today.description" tooltip="{{today.description}}"></span></h4>\n            <span class="label" ng-class="today.status.css">{{today.status.text}}</span>\n            <a class="btn btn-default btn-xs" ng-href="/#hours?library={{today.name}}" title="All hours {{today.name}}">See all hours <span class="fa fa-fw fa-chevron-right"></span></a>\n        </div>\n    </div>\n</div>')}]),angular.module("list/list.tpl.html",[]).run(["$templateCache",function(a){a.put("list/list.tpl.html",'<div class="responsive-table caryl-test">\n  <table class="table table-hover">\n    <tbody ng-repeat="lib in hoursList track by $index">\n    <tr ng-click="selectLib(lib)">\n      <td><a href="#" ng-href="#/hours?library={{lib.name}}">{{lib.name}}</a></td>\n      <td>{{lib.hours}}</td>\n      <td><span ng-class="lib.status.css">{{lib.status.text}}</span></td>\n      <td>\n        <span class="fa fa-lg fa-info-circle" ng-if="lib.description" tooltip="{{lib.description}}"></span>\n      </td>\n    </tr>\n        <tr class="hours-list-child" ng-repeat="child in lib.children track by $index" ng-click="selectLib(child)">\n          <td><a ng-href="#/hours?library={{child.name}}">{{child.name}}</a></td>\n          <td>{{child.hours}}</td>\n          <td><span ng-class="child.status.css">{{child.status.text}}</span></td>\n          <td>\n            <span class="fa fa-lg fa-info-circle" ng-if="child.description" tooltip="{{child.description}}"></span>\n          </td>\n        </tr>\n        \x3c!-- Williams Collection data is removed from the Database; therefore the data is hardcoded !--\x3e\n       <tr ng-if="lib.name == \'Gorgas Library\'" class="hours-list-child">\n            <td><a ng-href="https://www.lib.ua.edu/collections/williams/"> Williams Collection</a></td>\n            <td> Call for appt.</td>\n            <td> (205) 348-0500 </td>\n        </tr>\n    </tr>\n    </tbody>\n  </table>\n</div>\n')}]),angular.module("ualib.hours",["ngAnimate","ngRoute","ngResource","ui.bootstrap","oc.lazyLoad","angular.filter","ngMap","hours.common","hours.templates","hours.list","hours.calendar"]).config(["$ocLazyLoadProvider",function(a){}]),angular.module("hours",["ualib.hours"]),angular.module("hours.calendar",[]).controller("CalendarCtrl",["$scope","$location","$filter","hoursFactory","$rootScope",function(a,b,c,d,e){function f(b){var d,f,g,i;b=c("filterBy")(b,["library.name"],a.params.library),d=b[0].library.lid,f=b[0].library.name,g=b[0].calendar[a.params.month],i=b[0].defaultHours,a.params.lid=d,a.library=f,a.cal=h(g),a.defHours=i,e.$broadcast("hoursLoaded")}function g(){var c=b.search(),d=a.params;for(var e in c)d.hasOwnProperty(e)&&(d[e]=c[e]);a.params=d}function h(a){for(var b=0,c=a.weeks.length;b<c;b++)for(var d=0,e=a.weeks[b].length;d<e;d++){var f=[];a.weeks[b][d].hasOwnProperty("today")&&f.push("today"),a.weeks[b][d].hasOwnProperty("date")||f.push("not-current-month"),"Closed"===a.weeks[b][d].hoursTo&&f.push("closed"),a.weeks[b][d].hasOwnProperty("exc")&&f.push("exception"),a.weeks[b][d].css=f.join(" ")}return a}var i;a.cal,a.month,a.library,a.defHours,a.params={lid:1,month:0,library:"gorgas"},d.get({view:"calendar"}).$promise.then(function(b){g(),i=b.cal,f(i),a.$on("$locationChangeSuccess",function(){g(),f(i)})},function(a,b,c,d){console.log("Initial Error: "+a)}),a.getPrevMonth=function(){var c=parseInt(a.params.month)-1;c<0&&(c=0),b.search("month",c),b.replace()},a.getNextMonth=function(){var c=parseInt(a.params.month)+1;c>5&&(c=5),b.search("month",c),b.replace()}}]).directive("hoursCalendar",[function(){return{restrict:"AC",templateUrl:"calendar/calendar.tpl.html",controller:"CalendarCtrl"}}]),angular.module("hours.common",["common.hours"]),angular.module("common.hours",[]).factory("hoursFactory",["$resource",function(a){return a("//wwwdev2.lib.ua.edu/libhours2/api/:view",{},{get:{cache:!0}})}]),angular.module("ualib.hours").config(["$routeProvider",function(a){a.when("/hours",{reloadOnSearch:!1,templateUrl:"hours-locations/hours-locations.tpl.html",controller:"HoursLocationsCtrl"})}]).controller("HoursLocationsCtrl",["$scope","$location","NgMap",function(a,b,c){function d(){var b=a.params.lid-1,c=a.loc[b];a.center=[c.latitude,c.longitude],a.zoom=18,a.contact=c.contact,a.moreLink=c.link,a.library=c.name}var e=a.$on("hoursLoaded",function(){d()});a.center=[33.211803,-87.546032],a.googleMapsUrl="https://maps.googleapis.com/maps/api/js?key=AIzaSyCdXuKwZiDx5W2uP8plV5d-o-jLQ5UQtIQ&mid=z4A8-271j5C8.kowwE312jycE",a.loc=[{id:1,name:"Gorgas Library",latitude:33.211803,longitude:-87.546032,icon:"https://maps.google.com/mapfiles/ms/icons/yellow-dot.png",contact:{phone:[{number:"(205) 348-6047",dept:"Reference"},{number:"(205) 348-9748",dept:"Circulation"}],email:"gorgasinfo@ua.edu"},link:"/libraries/gorgas/"},{id:2,name:"Bruno Business Library",latitude:33.211107,longitude:-87.549255,icon:"https://maps.google.com/mapfiles/ms/icons/green-dot.png",contact:{phone:[{number:"(205) 348-1080"}],email:"brunolibrary@culverhouse.ua.edu"},link:"/libraries/bruno/"},{id:3,name:"Rodgers Library",latitude:33.2134785,longitude:-87.5427543,icon:"https://maps.google.com/mapfiles/ms/icons/red-dot.png",contact:{phone:[{number:"(205) 348-2100",dept:"Reference & Circulation"}],email:"scenglib@bama.ua.edu"},link:"/libraries/rodgers/"},{id:4,name:"Hoole Special Collections",latitude:33.210927,longitude:-87.543182,icon:"https://maps.google.com/mapfiles/ms/icons/blue-dot.png",contact:{phone:[{number:"(205) 348-0500",dept:"Front Desk"}],email:"archives@bama.ua.edu",alert:[{type:"info",msg:"For reference questions"}]},link:"/libraries/hoole/"},{id:5,name:"McLure Education Library",latitude:33.2104774,longitude:-87.5490442,icon:"https://maps.google.com/mapfiles/ms/icons/pink-dot.png",contact:{phone:[{number:"(205) 348-6055",dept:"Reference & Circulation"}]},link:"/libraries/mclure/"},{id:6,name:"Music Library",latitude:33.211803,longitude:-87.546032,icon:"https://maps.google.com/mapfiles/ms/icons/yellow-dot.png",link:"/libraries/music/"},{id:7,name:"Sanford Media Center",latitude:33.211803,longitude:-87.546032,icon:"https://maps.google.com/mapfiles/ms/icons/yellow-dot.png",contact:{phone:[{number:"(205) 348-4651"}]},link:"/using-the-library/sanford-media-center/"}],a.getDirections=function(){var b="https://www.google.com/maps/dir/"+a.directionsFrom+"/"+a.center[0]+","+a.center[1];window.open(b)},a.$on("$destroy",function(){e()})}]).directive("hoursLocationsMenu",["$location",function(a){return{restrict:"AC",link:function(a,b){function c(a){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]library=([^&#]*)"),c=b.exec(a);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}a.$on("$locationChangeSuccess",function(a,d,e){c(d)!==c(e)&&b.find("li").removeClass("active")})}}}]).directive("hoursHref",["$location",function(a){return{restrict:"A",scope:{hoursHref:"@"},link:function(b,c){function d(d){d.preventDefault(),b.$apply(function(){for(var b in f)a.search(b,f[b]),a.replace()}),c.parent().addClass("active")}var e=a.search().library||"gorgas",f=b.$eval(b.hoursHref);c.bind("click",d),-1!==e.toLowerCase().indexOf(f.library)&&c.parent().addClass("active"),b.$on("$destroy",function(){c.unbind("click")})}}}]),angular.module("ualib.hours").directive("libHoursToday",["hoursFactory","$filter",function(a,b){return{restrict:"EAC",replace:!0,scope:{library:"@"},templateUrl:"lib-hours-today/lib-hours-today.tpl.html",controller:["$scope","$element",function(c,d){function e(a){var b="open",c="label label",d={text:b,css:c+"-success"};return a.timeLeft<=7200&&a.timeLeft>0?(a.isOpen?d.text="closing soon":d.text="opening soon",d.css=c+"-warning"):a.isOpen||(d.text="closed",d.css=c+"-danger"),a.status=d,a}angular.isDefined(c.library)&&c.library;a.get({view:"today"},function(a){var f=[];if(angular.isDefined(a.today.libraries)){for(var g in a.today.libraries)f.push(a.today.libraries[g]),a.today.libraries[g].hasOwnProperty("children")&&(f=f.concat(a.today.libraries[g].children));var h=b("filter")(f,{name:c.library});c.today=e(h[0]),d.addClass("loaded")}else console.log("Error: could not retrieve today hours")},function(a){console.log(a)})}]}}]),angular.module("hours.list",[]).controller("ListCtrl",["$scope","$element","$animate","hoursFactory",function(a,b,c,d){function e(a){for(var b=[],c=0,d=a.length;c<d;c++){var f="open",g="label label",h={text:f,css:g+"-success"};a[c].timeLeft<=7200&&a[c].timeLeft>0?(a[c].isOpen?h.text="closing soon":h.text="opening soon",h.css=g+"-warning"):a[c].isOpen||(h.text="closed",h.css=g+"-danger"),a[c].status=h,angular.isObject(a[c].children)&&(a[c].children=e(a[c].children)),b.push(a[c])}return b}a.hoursList={},d.get({view:"today"},function(b){var c=e(b.today.libraries);a.hoursList=c},function(a){console.log(a)}),a.selectLib=function(b){a.libID=b.id}}]).directive("hoursList",[function(){return{restrict:"AC",templateUrl:"list/list.tpl.html",controller:"ListCtrl"}}]);